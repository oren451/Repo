#include "Product.h"
#include "FarmProduct.h"
#include "string.h"
#include "iostream"

using namespace std;

FarmProduct::FarmProduct(): Product()
{
	mName = "Default";
	mFarmType = Fruit;
	mSuppliersAmount = 0;
	mSeasonsNumber = 1;
}

FarmProduct::FarmProduct(string name, int id, ShelfRow place, int weight,
		ProductType type, ExposureValue exposure,int supplierNumber,FarmType farmtype
		, int seasonsnumber): Product(id, place, weight, type, exposure)
{
	mName = name;
	mFarmType = farmtype;

	if(seasonsnumber > 4 || seasonsnumber < 1)
	{
		throw "Wrong season number";
	}
	else
	{
		mSeasonsNumber = seasonsnumber;
	}
	mSuppliersAmount = supplierNumber;
}

FarmProduct::~FarmProduct() {
}

int FarmProduct::calculatePrice() {
	return (5 - mSeasonsNumber) + (5 * mSuppliersAmount) + mFarmType;
}

void FarmProduct::print() {
	Product::print();
	cout << " " << mName << " (" << mFarmType <<
			"," << mSeasonsNumber << "," << mSuppliersAmount << endl;
}

void FarmProduct::write(ostream& out) const {
	Product::write(out);
	out << "NAME: " << mName << endl;
	out << "SUPPLIER AMOUNT: " << mSuppliersAmount << endl;
	out << "FARM TYPE: " << mFarmType << endl;
	out << "SEASONS NUMBER: " << mSeasonsNumber << endl;
}

void FarmProduct::read(istream& in) {
}

void FarmProduct::save(ofstream& out) const {
	Product::save(out);

	out << mName << " ";
	out << mSuppliersAmount << " ";
	out << mFarmType << " ";
	out << mSeasonsNumber << " ";
}

void FarmProduct::load(ifstream& in) {
	Product::load(in);
	in >> mName >> mSuppliersAmount >> mFarmType >> mSeasonsNumber;
}

void FarmProduct::saveBin(ofstream& out) const {
	Product::saveBin(out);
	out.write((char*)&mName, sizeof(mName));
	out.write((char*)&mSuppliersAmount, sizeof(mSuppliersAmount));
	out.write((char*)&mFarmType, sizeof(mFarmType));
	out.write((char*)&mSeasonsNumber, sizeof(mSeasonsNumber));
}

void FarmProduct::loadBin(ifstream& in) {
	Product::loadBin(in);
	in.read((char*)&mName, sizeof(mName));
	in.read((char*)&mSuppliersAmount, sizeof(mSuppliersAmount));
	in.read((char*)&mFarmType, sizeof(mFarmType));
	in.read((char*)&mSeasonsNumber, sizeof(mSeasonsNumber));
}
